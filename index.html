<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>课表</title>
    <style>
        table {
            width: 100%;
            height: 100vh;
            table-layout: fixed;
        }

        table td,
        table th {
            border: 1px solid #eee;
            color: #000;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid black;
        }

        th,
        td {
            padding: 1px;
            font-size: 0.8em;
            text-align: center;
            line-height: 1.5;
        }

        th {
            background-color: #fff;
            position: sticky;
            top: 0;
            z-index: 1;
            font-size: 1.1em;
            letter-spacing: -1px;
        }

        td {
            text-align: left;
        }
    </style>
</head>

<body>
    <div>
        <div style="float: left;">
            工设(专升本)241
        </div>
        <div style="float: right;font-size: larger">
            <label for="weekSelect">选择第几周&nbsp;</label>
            <select id="weekSelect">
            </select>
        </div>
    </div>
    <br>
    <br>
    <script>
        const totalWeeks = 24;
        const weekSelect = document.getElementById('weekSelect');
        // 计算当前周数
        function getCurrentWeek() {
            const today = new Date();
            const firstDayOfYear = new Date(today.getFullYear(), 9 - 1, 2);
            const dayOfYear = Math.floor((today - firstDayOfYear) / (24 * 60 * 60 * 1000));
            const weekOfYear = Math.ceil((dayOfYear + firstDayOfYear.getDay()) / 7);
            return weekOfYear;
        }
        // 动态生成下拉框选项
        function generateWeekOptions(totalWeeks) {
            const weekSelect = document.getElementById('weekSelect');
            for (let i = 1; i <= totalWeeks; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `第${i}周`;
                weekSelect.appendChild(option);
            }
        }
        generateWeekOptions(24)
        // 计算指定星期的具体日期
        function calculateDateForDay(dayOfWeek) {
            const today = new Date();
            const startDate = new Date(today.getFullYear(), 9 - 1, 2);
            const days = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
            const dayIndex = days.indexOf(dayOfWeek);
            return new Date(startDate.getTime() + ((+weekSelect.value - 1) * 7 + dayIndex) * 24 * 60 * 60 * 1000).getDate();
        }
    </script>
    <table>
    </table>
    <script>
        data = [[{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '设计构成B',
            '星期': 5,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '设计构成B',
            '星期': 5,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '摄影与摄像',
            '星期': 4,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '裘柯槟,陈鲁（设计）',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 5,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        }],
        [{
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '结构素描',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '选修',
            '课程性质': '实验课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠,郑乐晓',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计构成B',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '2.5',
            '教师': '马梦云,齐延成',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '计算机辅助形态设计（双语）',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '蒋姗姗（设计）',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '工业设计方法',
            '星期': 2,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A543',
            '修': '必修',
            '课程性质': '专业核心课',
            '教室类型': '多媒体教室',
            '学分': '2.0',
            '教师': '马梦云,张惠文',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '结构素描',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '选修',
            '课程性质': '实验课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠,郑乐晓',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '结构素描',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A601',
            '修': '选修',
            '课程性质': '实验课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠,郑乐晓',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '结构素描',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A608',
            '修': '选修',
            '课程性质': '实验课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠,郑乐晓',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '工业设计史',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '张惠文',
            '课程时间': '1-4',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '人机工程学',
            '星期': 3,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A432',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '多媒体教室',
            '学分': '3.0',
            '教师': '左雨欣,许俊恒',
            '课程时间': '1-4',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '设计造型基础',
            '星期': 4,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [{
            '课程名字': '设计造型基础',
            '星期': 1,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '6-9',
            '符号': '◆',
            '类型': '理论',
            '本周第几个课程': '01'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 2,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '◇',
            '类型': '实验',
            '本周第几个课程': '02'
        },
        {
            '课程名字': '计算机辅助平面设计',
            '星期': 3,
            '教室': '设计实验楼',
            '教学楼': '数字化设计实验室',
            '修': '必修',
            '课程性质': '实验课',
            '教室类型': '时尚设计学院实验室',
            '学分': '3.0',
            '教师': '许俊恒,张惠文',
            '课程时间': '6-9',
            '符号': '●',
            '类型': '上机',
            '本周第几个课程': '03'
        },
        {
            '课程名字': '设计造型基础',
            '星期': 4,
            '教室': '南区第二教学楼A楼',
            '教学楼': '教二A613',
            '修': '必修',
            '课程性质': '专业基础课',
            '教室类型': '南区制图室',
            '学分': '3.0',
            '教师': '骆勇忠',
            '课程时间': '1-4',
            '符号': '★',
            '类型': '实践',
            '本周第几个课程': '04'
        }],
        [],
        [],
        [],
        [],
        [],
        [],
        []]
        // 获取表格元素
        time = {
            1: '08:00',
            2: '08:45',
            3: '09:45',
            4: '10:30',
            5: '11:15',
            6: '13:30',
            7: '14:15',
            8: '15:15',
            9: '16:00',
            10: '16:45',
            11: '18:30',
            12: '19:15',
            13: '20:00'
        }
        // time = {
        //     1: '08:00-08:40',
        //     2: '08:45-09:25',
        //     3: '09:45-10:25',
        //     4: '10:30-11:10',
        //     5: '11:15-11:55',
        //     6: '13:30-14:10',
        //     7: '14:15-14:55',
        //     8: '15:15-15:55',
        //     9: '16:00-16:40',
        //     10: '16:45-17:25',
        //     11: '18:30-19:10',
        //     12: '19:15-19:55',
        //     13: '20:00-20:40'
        // }
        var table = document.querySelector('table')
        function reTable() {
            var table = document.querySelector('table')
            table.innerHTML = ''
            const th = document.createElement('tr')
            th.innerHTML = '<th>节次</th><th>一<div style="color:#888">' + calculateDateForDay('周一') + '</div>\
                </th><th>二<div style="color:#888">'+ calculateDateForDay('周二') + '</div>\
                    </th><th>三<div style="color:#888">'+ calculateDateForDay('周三') + '</div>\
                        </th><th>四<div style="color:#888">'+ calculateDateForDay('周四') + '</div>\
                            </th><th>五<div style="color:#888">'+ calculateDateForDay('周五') + '</div>\
                                </th><th>六<div style="color:#888">'+ calculateDateForDay('周六') + '</div>\
                                    </th><th>日<div style="color:#888">'+ calculateDateForDay('周日') + '</div>\
                                        </th>'
            table.appendChild(th)
            for (let i = 0; i < 13; i++) {
                const tr = document.createElement('tr')
                tr.innerHTML = '<td><div style="text-align:center">' + (i + 1) + '<div><div style="color:#888">' + time[(i + 1)] + '</div></td>'
                for (let j = 0; j < 7; j++) {
                    tr.innerHTML += '<td></td>'
                }
                table.appendChild(tr)
            }

            return table
        }
        function lessonsSet(data) {
            reTable()
            const timeconnect = data.map(element => element.课程时间);
            const weekLesson = data.map(element => element.星期);

            function getCourseInfo(row, col) {
                return table.rows[row].cells[col];
            }

            timeconnect.forEach((element, index) => {
                const nodes = element.split('-');
                const delrows = +nodes[1] - nodes[0] + 1;
                const rowSpanCell = getCourseInfo(nodes[0], weekLesson[index]);
                rowSpanCell.rowSpan = delrows;
                const txt = '<strong>' + data[index]['课程名字'] + '</strong> [' + data[index]['符号'] + data[index]['类型'] + ']<div style="padding:2px 0 2px 0;margin:2px 0 2px 0;letter-spacing: -1px;">@' + data[index]['教学楼'] + '</div>' + data[index]['教师'] + '<br>' + data[index]['学分']
                rowSpanCell.innerHTML = txt
                rowSpanCell.style.backgroundColor = randomHSLA()
                for (let i = +nodes[0] + 1; i <= nodes[1]; i++) {
                    getCourseInfo(i, weekLesson[index]).remove();
                }
            });
        }
        function randomHSLA() {
            return `hsla(${~~(360 * Math.random())}, 70%,  72%, 0.8)`
        }
        let weeknow = getCurrentWeek() + 1
        lessonsSet(data[weeknow ? weeknow : 0])
        // 监听下拉框变化
        weekSelect.addEventListener('change', (event) => {
            const selectedWeek = +event.target.value - 1;
            lessonsSet(data[selectedWeek])
        });
    </script>
</body>

</html>